# Plankton Simulator

## Summary
The plankton-simulator is a collection of matlab scripts simulating the dynamics of structured microbial communities. 
The simulator is based on a multiscale biophysical model that incorporates species traits, consumer-resource dynamics and stochastic ecosystem assembly. 
The model hierarchically simulates features of ecosystem at different scales by defining three classes in the ecosystem using object-oriented programming in MATLAB: Species, Demes (spatially-isolated subcompartments) and Plankton (collection of Demes).


# How to run the Simulator

1. Download and extract the repository; alternatively, clone the repository using Git with the command
```git clone https://github.com/scaralbi/plankton-simulator.git```

2. Open MATLAB 

3. Open ```config.m``` 

4. Specify desired parameters (```params```), as described in file ```params_guide.txt```   

5. Run ```config.m``` 

6. Open and execute ```simulator.m```

7. To visualise simulation plots and statistics execute ```data_reader.m``` 



# Overview of the files in the plankton-simulator folder:

* [`Species.m`](https://github.com/scaralbi/plankton-simulator/blob/master/Species.m )
: defines the Species class and the functions that can be applied its objects
* [`Deme.m`](https://github.com/scaralbi/plankton-simulator/blob/master/Deme.m )
: defines the Deme class and its functions
* [`Plankton.m`](https://github.com/scaralbi/plankton-simulator/blob/master/Plankton.m ): defines the Plankton class and its functions
* [`dynamics.m`](https://github.com/scaralbi/plankton-simulator/blob/master/dynamics.m ): contains the ordinary differential equations that describe the population and concentration dynamics within ecosystem
* [`config.m`](https://github.com/scaralbi/plankton-simulator/blob/master/config.m ): script that generates configurations files (config.mat) with speciefied simulation options and parameters
* [`simulator.m`](https://github.com/scaralbi/plankton-simulator/blob/master/simulator.m ): script that reads config files and simulate ecosystem and save data as config_data.mat files
* [`data_reader.m`](https://github.com/scaralbi/plankton-simulator/blob/master/data_reader.m ): script that reads config_data.mat files and produces plots and statistics



# [**`Species.m`: Class defining species**](https://github.com/scaralbi/plankton-simulator/blob/master/Species.m )

Every Species is defined by the following properties:

```Matlab
classdef Species    
    properties
        name = 0;
        traits = [];
        population = 0;
```
* **`name`** Every species has a name, defined as a positive integer
* **`traits`** are the metabolic strategies (rate of uptake of each nutrient). Other traits can be included such as size, sedimentation rates, self-shading coefficients. With the resource-competition model described by [`dynamics.m`](https://github.com/scaralbi/plankton-simulator/blob/master/dynamics.m ) only uptake rates coefficient (![equation](http://www.sciweavers.org/tex2img.php?eq=%5Coverrightarrow%7B%5Calpha_%7B%5Csigma%20i%7D%7D%20%3D%20%28%5Calpha_%7B1%7D%2C...%2C%5Calpha_%7Bp%7D%29&bc=White&fc=Black&im=png&fs=12&ff=arev&edit=0)
 are considered. 

 
 
* **`population`** population size defined as a positive real number

![alt text](https://github.com/scaralbi/plankton-simulator/blob/master/species.png)

# [**`Deme.m`: Class defining an ecotype**](https://github.com/scaralbi/plankton-simulator/blob/master/Deme.m ) 
A deme is a spatially isolated subcompartemnt of the ecosystem, where the the concentrations of resource are assumed to be homogeneous. 
A Deme is characterised by the following properties:
```Matlab
classdef Deme    
    properties
        nutrient_concentrations = [];
        nutrient_supply = [];
        species_composition = [];
```
* **`nutrient_concentrations:`** concentration of each nutrient
* **`nutrient_supply:`** rate of nutrient supply. 
* **`species composition:`** list of Species objects, representing the species present within the deme

# [**`Plankton.m: Class defining the ecosystem`**](https://github.com/scaralbi/plankton-simulator/blob/master/Plankton.m ) 
The Plankton class defines the ecosystem as a matrix of demes. 

```Matlab
classdef Plankton    
    properties
        demes = [];
        size = [];
    end
```
* **`demes:`** matrix of Demes objects
* **`size:`** dimensions of demes matrix


# [**`simulator.m`**](https://github.com/scaralbi/plankton-simulator/blob/master/simulator.m ) 
This is the main function of the plankton-simulator. It executes config.mat files generated by ```config.m```  and saves the outputs as config_data.mat 

## Stochastic Ecosystem Assembly - Algorithm
![alt text](https://github.com/scaralbi/plankton-simulator/blob/master/flowchart.png)

1. Init
2. Evolve metabolic strategies (drawn from uniform distribution)
3. Specify nutrient types and supplies
4. Simulate

# # [**`config.m`**](https://github.com/scaralbi/plankton-simulator/blob/master/config.m ) 
 
The file ```params_guide.txt``` contains a list of the reference parameter.





